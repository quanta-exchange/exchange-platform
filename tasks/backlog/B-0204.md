# B-0204 â€” Edge: request authentication & replay protection hardening

## Goal
Harden API auth, timestamp skew handling, nonce/replay detection, and key management.

## Scope
- Timestamp skew window policy
- Nonce or request hash replay cache (Redis)
- Per-key rate limits and allowlists
- Key rotation API (admin later)

## Acceptance Criteria
- Invalid signature rejected
- Replay attempts detected and rejected
- Rotation does not break existing sessions within grace period

## Tests
- Security tests: replay, skew, wrong sig
- Load test for auth path overhead

## Observability
- Metrics: auth_fail_total{reason}, replay_detect_total

## Rollback / Recovery
- If auth outage, fail closed (reject) rather than accept unsafe trades

## Dependencies
- B-0201
- B-0203
