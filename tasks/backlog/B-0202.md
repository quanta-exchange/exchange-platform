# B-0202 â€” Edge Gateway WS v1 (subscribe, snapshot+delta, gap recovery)

## Goal
Provide production-grade WebSocket market data with backpressure.

## Scope
- WS protocol: SUB/UNSUB/RESUME
- Channels: trades/book/ticker/candles
- Snapshot on subscribe; deltas with seq
- Gap detection and resync

## Acceptance Criteria
- Slow consumer policy enforced (queue limit + close)
- Conflation for book/candles
- Trades channel loss-minimized

## Tests
- Load test: N connections, message rate stable
- Gap recovery tests
- Snapshot correctness tests

## Observability
- Metrics: ws_connections, ws_close_reason_total, publish_lag_ms

## Rollback / Recovery
- If WS overload, enable stricter conflation and reduce depth default; rollback if needed

## Dependencies
- I-0003
- B-0201
